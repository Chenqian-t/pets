<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
    <title>宠物资讯</title>
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
</head>
<body>
	<div id="wrap">
		<div class="head">
			<div class="logo">
				<img src="imgs/logo.jpg"/>
			</div>
			<form action="#" method="get" class="search">
				<input type="text" placeholder="哈士奇" />
				<input type="submit" value="搜索" />
			</form>
			<span class="meum-btn"></span>
		</div>
		<div class="mask">
			<div class="mask-left">
				<ul>
					<li class="active">狗类</li>
					<li>猫类</li>
					<li>龟类</li>
				</ul>
			</div>
			<div class="mask-right">
				<p>
					&minus;&minus;&nbsp;狗类&nbsp;&minus;&minus;
				</p>
				<div class="mask-right-content">
					<ul>
						<li>
							<a href="#">哈士奇</a>
						</li>
						<li>
							<a href="#">柯基</a>
						</li>
						<li>
							<a href="#">柴犬</a>
						</li>
						<li>
							<a href="#">边牧</a>
						</li>
						<li>
							<a href="#">博美</a>
						</li>
						<li>
							<a href="#">松狮</a>
						</li>
						<li>
							<a href="#">杜宾</a>
						</li>
						<li>
							<a href="#">斗牛</a>
						</li>
					</ul>
					<ul>
						<li>
							<a href="#">橘猫</a>
						</li>
						<li>
							<a href="#">暹罗猫</a>
						</li>
						<li>
							<a href="#">布偶猫</a>
						</li>
						<li>
							<a href="#">英国短毛猫</a>
						</li>
						<li>
							<a href="#">美国短毛猫</a>
						</li>
						<li>
							<a href="#">缅因猫</a>
						</li>
						<li>
							<a href="#">狸花猫</a>
						</li>
						<li>
							<a href="#">折耳猫</a>
						</li>
					</ul>
					<ul>
						<li>
							<a href="#">金钱龟</a>
						</li>
						<li>
							<a href="#">大鳄龟</a>
						</li>
						<li>
							<a href="#">麝香龟</a>
						</li>
						<li>
							<a href="#">绿海龟</a>
						</li>
						<li>
							<a href="#">印度星龟</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="content">
			<div class="content-package">
				<div class="carousel-wrap" needAuto>
					<div class="points-wrap"></div>
				</div>
				<div class="content-card">
					<div class="content-card-top">
						<h2>汪星人专区</h2>
						<ul>
							<li>哈士奇</li>
							<li>柯基</li>
							<li>柴犬</li>
							<li>边牧</li>
							<li>博美</li>
						</ul>
						<span class="more">
							<a href="#">更多&gt;</a>
						</span>
						<div class="smallGreen"></div>
					</div>
					<div class="content-card-list">
						<div class="card-list-wrap">
							<div class="loading"></div>
							<ul class="list">
								<li>
									<a href="#">
										<img src="imgs/husky01.jpg"/>
									</a>
									<a href="#">
										<span>哈士奇可是一种不是所有人都配养的狗子，想要饲养哈士奇首先你必须要有一颗非常强大的内心，来面对各种奇葩的事情，还要拥有足够大的力气，才能拉住它突然犯二的身体，最后你还必须要有很要的经济条件，这样才能支撑下哈士奇给你安排的各大装修计划</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky02.jpg"/>
									</a>
									<a href="#">
										<span>要不是监控拍下全过程，真的很难相信，哈士奇还有这样一面？</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky03.jpg"/>
									</a>
									<a href="#">
										<span>哈士奇在现如今的宠物圈，有着非常卓越的地位，甚至可以将它称为宠物狗“一哥”。并且因其长相帅气，性格“夸张”，不论它走到哪里，都能给人们带来欢乐。但哈士奇的性格跟习性有些太过夸张，导致在饲养过程中，往往会出现很多让人啼笑皆非的事情。就去年而言，前有为消磨哈士奇精力，主人让哈士奇拉车干农活，后有养哈士奇的铲屎官，为防止哈士奇拆家，集体带哈士奇夜跑5公里（都是真事）。</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky04.jpg"/>
									</a>
									<a href="#">
										<span>5月下旬，笔者在某短视频平台上，发现了一则很有趣的视频，视频的背景是一家农家小院，院子中间放着一只小木桌，桌上放了一个磨盘，磨盘上拴着一只哈士奇，并且这只哈士奇，正在像一只驴子一样，乖乖拉着磨盘转动。</span>
									</a>
								</li>
							</ul>
							<div class="loading"></div>
						</div>
					</div>
				</div>
				<div class="content-card">
					<div class="content-card-top">
						<h2>喵星人专区</h2>
						<ul>
							<li>橘猫</li>
							<li>布偶猫</li>
							<li>狸花猫</li>
							<li>折耳猫</li>
							<li>美国短毛猫</li>
						</ul>
						<span class="more">
							<a href="#">更多&gt;</a>
						</span>
						<div class="smallGreen"></div>
					</div>
					<div class="content-card-list">
						<div class="card-list-wrap">
							<div class="loading"></div>
							<ul class="list">
								<li>
									<a href="#">
										<img src="imgs/husky01.jpg"/>
									</a>
									<a href="#">
										<span>哈士奇可是一种不是所有人都配养的狗子，想要饲养哈士奇首先你必须要有一颗非常强大的内心，来面对各种奇葩的事情，还要拥有足够大的力气，才能拉住它突然犯二的身体，最后你还必须要有很要的经济条件，这样才能支撑下哈士奇给你安排的各大装修计划</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky02.jpg"/>
									</a>
									<a href="#">
										<span>要不是监控拍下全过程，真的很难相信，哈士奇还有这样一面？</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky03.jpg"/>
									</a>
									<a href="#">
										<span>哈士奇在现如今的宠物圈，有着非常卓越的地位，甚至可以将它称为宠物狗“一哥”。并且因其长相帅气，性格“夸张”，不论它走到哪里，都能给人们带来欢乐。但哈士奇的性格跟习性有些太过夸张，导致在饲养过程中，往往会出现很多让人啼笑皆非的事情。就去年而言，前有为消磨哈士奇精力，主人让哈士奇拉车干农活，后有养哈士奇的铲屎官，为防止哈士奇拆家，集体带哈士奇夜跑5公里（都是真事）。</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky04.jpg"/>
									</a>
									<a href="#">
										<span>5月下旬，笔者在某短视频平台上，发现了一则很有趣的视频，视频的背景是一家农家小院，院子中间放着一只小木桌，桌上放了一个磨盘，磨盘上拴着一只哈士奇，并且这只哈士奇，正在像一只驴子一样，乖乖拉着磨盘转动。</span>
									</a>
								</li>
							</ul>
							<div class="loading"></div>
						</div>
					</div>
				</div>
				<div class="content-card">
					<div class="content-card-top">
						<h2>乌龟专区</h2>
						<ul>
							<li>金钱龟</li>
							<li>大鳄龟</li>
							<li>麝香龟</li>
							<li>绿海龟</li>
							<li>印度星龟</li>
						</ul>
						<span class="more">
							<a href="#">更多&gt;</a>
						</span>
						<div class="smallGreen"></div>
					</div>
					<div class="content-card-list">
						<div class="card-list-wrap">
							<div class="loading"></div>
							<ul class="list">
								<li>
									<a href="#">
										<img src="imgs/husky01.jpg"/>
									</a>
									<a href="#">
										<span>哈士奇可是一种不是所有人都配养的狗子，想要饲养哈士奇首先你必须要有一颗非常强大的内心，来面对各种奇葩的事情，还要拥有足够大的力气，才能拉住它突然犯二的身体，最后你还必须要有很要的经济条件，这样才能支撑下哈士奇给你安排的各大装修计划</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky02.jpg"/>
									</a>
									<a href="#">
										<span>要不是监控拍下全过程，真的很难相信，哈士奇还有这样一面？</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky03.jpg"/>
									</a>
									<a href="#">
										<span>哈士奇在现如今的宠物圈，有着非常卓越的地位，甚至可以将它称为宠物狗“一哥”。并且因其长相帅气，性格“夸张”，不论它走到哪里，都能给人们带来欢乐。但哈士奇的性格跟习性有些太过夸张，导致在饲养过程中，往往会出现很多让人啼笑皆非的事情。就去年而言，前有为消磨哈士奇精力，主人让哈士奇拉车干农活，后有养哈士奇的铲屎官，为防止哈士奇拆家，集体带哈士奇夜跑5公里（都是真事）。</span>
									</a>
								</li>
								<li>
									<a href="#">
										<img src="imgs/husky04.jpg"/>
									</a>
									<a href="#">
										<span>5月下旬，笔者在某短视频平台上，发现了一则很有趣的视频，视频的背景是一家农家小院，院子中间放着一只小木桌，桌上放了一个磨盘，磨盘上拴着一只哈士奇，并且这只哈士奇，正在像一只驴子一样，乖乖拉着磨盘转动。</span>
									</a>
								</li>
							</ul>
							<div class="loading"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="scroll-bar"></div>
		</div>
	</div>
</body>
<script src="js/carousel.js"></script>
<script type="text/javascript">
	window.onload = function () {
		document.addEventListener("touchstart", function (e) {
			e = e || event;
			e.preventDefault();
		});
		(function () {
            let styleNode = document.createElement("style");
            let w = document.documentElement.clientWidth/16;
            styleNode.innerHTML = "html {font-size: " + w + "px !important;}";
            document.head.appendChild(styleNode);
        })();
        
        // 输入框获焦
        changeFocus();
        function changeFocus() {
        	var inputText = document.querySelector("#wrap .head .search input[type=text]");
        	inputText.addEventListener("touchstart", function (e) {
        		e = e || event;
        		this.focus();
        		e.stopPropagation();
        		e.preventDefault();
        	});
        	document.addEventListener("touchstart", function () {
        		inputText.blur();
        	})
        }
        
        //遮罩层是否显示
        maskShowAble();
        function maskShowAble() {
        	var meumBtn = document.querySelector("#wrap .head .meum-btn");
        	var mask = document.querySelector("#wrap .mask");
        	var w = mask.clientWidth;
        	
        	var isMaskOpen = false;
        	
        	mask.style.transition = "1s transform";
        	meumBtn.addEventListener("touchend", function () {
        		if (isMaskOpen) {
        			meumBtn.classList.remove("active");
        			demo.css(mask, "translateX", 0);
        		} else {
        			meumBtn.classList.add("active");
        			demo.css(mask, "translateX", -w);
        		}
        		isMaskOpen = !isMaskOpen;
        	});
        }
        
        //遮罩层内部逻辑
        maskClick();
        function maskClick() {
        	var leftBtn = document.querySelector("#wrap .mask .mask-left ul");
        	var rightTitle = document.querySelector("#wrap .mask .mask-right p");
        	var rightContent = document.querySelector("#wrap .mask .mask-right .mask-right-content");
        	
        	var w = rightContent.clientWidth/3;
        	
        	leftBtn.addEventListener("touchend", function (ev) {
        		ev = ev || event;
        		var targrtLi = ev.changedTouches[0].target;
        		for (var i = 0; i < leftBtn.children.length; i++) {
        			leftBtn.children[i].classList.remove("active");
        		}
        		switch (targrtLi.innerText){
        			case "狗类":
        				targrtLi.classList.add("active");
        				rightTitle.innerHTML = "&minus;&minus;&nbsp;"+targrtLi.innerText+"&nbsp;&minus;&minus;";
        				demo.css(rightContent, "translateX", 0);
        				break;
        			case "猫类":
        				targrtLi.classList.add("active");
        				rightTitle.innerHTML = "&minus;&minus;&nbsp;"+targrtLi.innerText+"&nbsp;&minus;&minus;";
        				demo.css(rightContent, "translateX", -w);
        				break;
        			case "龟类":
        				targrtLi.classList.add("active");
        				rightTitle.innerHTML = "&minus;&minus;&nbsp;"+targrtLi.innerText+"&nbsp;&minus;&minus;";
        				demo.css(rightContent, "translateX", -2*w);
        				break;
        			default:
        				break;
        		}
        	});
        	
        }
        
        //轮播图
        carouselWrapper();
        function carouselWrapper() {
        	var imgsArr = ["imgs/cat-banner.jpg", "imgs/dog-banner.jpg", "imgs/turtle-banner.jpg", "imgs/dog2-banner.jpg",];
			demo.carousel(imgsArr);
        }
        
        
        //cardList切换
        cardListChange();
        function cardListChange() {
        	var cardWraps = document.querySelectorAll("#wrap .content .content-package .content-card .content-card-list");
        	var cardItems = document.querySelectorAll("#wrap .content .content-package .content-card .content-card-list .card-list-wrap");
        	
        	var w = cardWraps[0].offsetWidth;
        	for (var i = 0; i < cardWraps.length; i++) {
        		move(cardWraps[i], cardItems[i]);
        	}
        	
        	function move(wrapper, content) {
        		// 抽象小绿下标
        		var flag = 0;
        		var smallGreen = wrapper.parentNode.querySelector(".content-card-top .smallGreen");
        		
        		var topNavs = wrapper.parentNode.querySelectorAll(".content-card-top ul li");
        		smallGreen.style.width = topNavs[0].offsetWidth + "px";
        		var loadings = content.querySelectorAll(".loading");
	        	demo.css(content, "translateX", -w);
	        	
				// 滑屏逻辑	        	
	        	var startPoint = {x: 0, y: 0,};
	        	var elementPoint = {x: 0, y: 0,};
	        	
	        	// 防抖动
	        	var isX = true;
	        	var isFirst = true;
	        	
	        	var isOver = false;
	        	
	        	wrapper.addEventListener("touchstart", function (ev) {
	        		if (isOver) {
        				return;
        			}
	        		ev = ev || event;
	        		var touchC = ev.changedTouches[0];
	        		startPoint.x = touchC.clientX;
	        		startPoint.y = touchC.clientY;
	        		elementPoint.x = demo.css(content, "translateX");
	        		elementPoint.y = demo.css(content, "translateY");
	        		
	        		isX = true;
	        		isFirst = true;
	        		
	        		content.style.transition = "none";
	        	});
	        	wrapper.addEventListener("touchmove", function (ev) {
	        		if (isOver) {
        				return;
        			}
	        		if (!isX) {
	        			return;
	        		}
	        		ev = ev || event;
	        		var touchC = ev.changedTouches[0];
	        		var nowPoint = {x: 0, y: 0,};
	        		var dis = {x: 0, y: 0,};
	        		nowPoint.x = touchC.clientX;
	        		nowPoint.y = touchC.clientY;
	        		dis.x = nowPoint.x - startPoint.x;
	        		dis.y = nowPoint.y - startPoint.y;
	        		
	        		if (isFirst) {
	        			isFirst = false;
	        			if (Math.abs(dis.y) > Math.abs(dis.x)) {
	        				isX = false;
	        				return;
	        			}
	        		}
	        		
	        		var translateX = elementPoint.x + dis.x;
	        		demo.css(content, "translateX", translateX);
	        		
	        		// 1/2跳转
	        		if (isOver) {
        				return;
        			}
	        		if (Math.abs(dis.x) > w/2) {
	        			isOver = true;
	        			content.style.transition = "1s transform";
	        			dis.x > 0 ? demo.css(content, "translateX", 0) : demo.css(content, "translateX", -2*w);
	        			
	        			//请求
	        			content.addEventListener("transitionend", endFn);
	        			content.addEventListener("webkitTransitionEnd", endFn);
	        			
	        			function endFn() {
	        				content.removeEventListener("transitionend", endFn);
	        				content.removeEventListener("webkitTransitionEnd", endFn);
	        				content.style.transition = "none";
	        				
	        				for (let i = 0; i < loadings.length; i++) {
	        					loadings[i].style.opacity = 1;
	        				}
	        				
	        				// 小绿逻辑
	        				dis.x > 0 ? flag-- : flag++;
	        				if (flag < 0) {
	        					flag = topNavs.length - 1;
	        				} else if (flag > topNavs.length - 1) {
	        					flag = 0;
	        				}
	        				smallGreen.style.width = topNavs[flag].offsetWidth + "px";
	        				demo.css(smallGreen, "translateX", topNavs[flag].offsetLeft);
	        				
	        				// ajax请求  拿数据
	        				setTimeout(function () {
	        					for (let i = 0; i < loadings.length; i++) {
		        					loadings[i].style.opacity = 0;
		        				}
	        					demo.css(content, "translateX", -w);
	        					isOver = false;
	        				}, 2000)
	        			}
	        		}
	        	});
	        	wrapper.addEventListener("touchend", function (ev) {
	        		if (isOver) {
        				return;
        			}
	        		ev = ev || event;
	        		var touchC = ev.changedTouches[0];
	        		var nowPoint = {x: 0, y: 0,};
	        		var dis = {x: 0, y: 0,};
	        		nowPoint.x = touchC.clientX;
	        		dis.x = nowPoint.x - startPoint.x;
	        		if (Math.abs(dis.x) <= w/2) {
	        			content.style.transition = "1s transform";
	        			demo.css(content, "translateX", -w);
	        		}
	        	});
        	}
        }
	
	
        //竖向滑屏
        vMove();
        function vMove() {
        	var scrollBar = document.querySelector("#wrap .content .scroll-bar");
        	var wrapper = document.querySelector("#wrap .content");
			var contentPackage = document.querySelector("#wrap .content .content-package");
			
        	var callBack = {
				start: function () {
					scrollBar.style.height = wrapper.offsetHeight*(wrapper.offsetHeight/this)+"px";
					scrollBar.style.opacity = 1;
				},
				move: function () {
					var scale = -document.documentElement.clientHeight/this.offsetHeight;
					demo.css(scrollBar, "translateY", scale*demo.css(this, "translateY"));
				},
				end: function () {
					scrollBar.style.opacity = 0;
				},
			};
        	
        	demo.verticalMove(wrapper, callBack);
        }
	}
</script>
</html>